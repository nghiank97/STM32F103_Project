#include "use.h"

void gpio_init(void){
	RCC->APB2ENR |= (1<<4);
	GPIOC->CRH &=~ 0x00F00000;
	GPIOC->CRH |= (B0110<<20);
}

void tim_2_init(void){
	RCC->APB1ENR |= (1<<0);
	TIM2->CNT = 0;
	TIM2->PSC = 71;
	TIM2->ARR = 749;
	TIM2->CR1 &=~	(1<<1);
	TIM2->DIER |= (1<<0);
	TIM2->BDTR |= (1<<15)|(1<<13); 
	TIM2->CR1 |= (1<<0);
	NVIC->IP[6] = (0<<0);
	NVIC->ISER[0] = (1<<28);
}

#define LED_TOGGLE() {GPIOC->ODR ^= (1<<13);}

void TIM2_IRQHandler(void)
{
	if (TIM2->SR & (1<<0))
	{
		LED_TOGGLE();
	}
	TIM2->SR &=~ (1<<0);
}


extern void setup(void){
	gpio_init();
	tim_2_init();
	
}

extern void loop(void){
}



